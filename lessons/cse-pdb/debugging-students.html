<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by LibreOffice - see http://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">- no title specified</title><meta name="DCTERMS.title" content="" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.issued" content="2013-10-17T21:42:54.239734000" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.modified" content="2013-10-17T21:43:42.001098000" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.gr1 { font-size:12pt; font-family:Times New Roman; writing-mode:lr-tb; padding-top:0.0201in; padding-bottom:0.0201in; padding-left:0.0201in; padding-right:0.0201in; vertical-align:top; }
	.P1 { font-size:10pt; margin-bottom:0in; margin-top:0in; font-family:Linux Libertine O; writing-mode:page; }
	.P10 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P11 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P12 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:normal; }
	.P13 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:normal; }
	.P14 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:normal; }
	.P15 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:normal; }
	.P16 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:normal; }
	.P17 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:normal; }
	.P18 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P19 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P2 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P20 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P21 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P22 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P23 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P24 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P25 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P26 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P27 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P28 { font-size:16pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; font-weight:bold; }
	.P29 { font-size:16pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; font-weight:bold; }
	.P3 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P30 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P31 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P32 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P33 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P34 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P35 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P36 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; color:#0084d1; font-style:italic; }
	.P37 { font-size:12pt; font-family:Ubuntu Mono; writing-mode:page; }
	.P38 { font-size:12pt; font-family:Ubuntu Mono; writing-mode:page; font-style:normal; }
	.P39 { font-size:12pt; font-family:Ubuntu Mono; writing-mode:page; }
	.P4 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; text-align:center ! important; }
	.P40 { font-size:12pt; font-family:Ubuntu Mono; writing-mode:page; }
	.P41 { font-size:12pt; font-family:Ubuntu Mono; writing-mode:page; }
	.P42 { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.P43 { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.P44 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:italic; }
	.P45 { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.P46 { font-size:12pt; font-family:Times New Roman; writing-mode:page; }
	.P47 { font-size:12pt; font-family:Ubuntu Mono; writing-mode:page; margin-left:0.5in; margin-right:0in; text-indent:0in; }
	.P48 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; color:#0084d1; font-style:italic; }
	.P49 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; margin-left:0.4925in; margin-right:0in; text-indent:0in; }
	.P5 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P50 { font-size:24pt; font-family:Ubuntu; writing-mode:page; text-align:center ! important; color:#0084d1; font-style:normal; font-weight:normal; }
	.P51 { font-size:12pt; font-family:Times New Roman; writing-mode:page; text-align:center ! important; }
	.P6 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.P7 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:italic; }
	.P8 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; font-style:italic; }
	.P9 { font-size:12pt; font-family:Linux Libertine O; writing-mode:page; }
	.Bullet_20_Symbols { color:#0084d1; font-family:OpenSymbol; }
	.Source_20_Text { font-family:Courier New; }
	.T1 { font-size:9pt; font-style:normal; }
	.T13 { font-style:normal; }
	.T14 { font-style:normal; }
	.T15 { font-style:normal; }
	.T16 { font-style:normal; }
	.T17 { font-style:normal; }
	.T19 { font-family:Ubuntu Mono; }
	.T2 { font-size:9pt; font-style:normal; }
	.T20 { font-family:Ubuntu Mono; font-style:normal; }
	.T21 { font-family:Ubuntu Mono; font-style:normal; }
	.T22 { font-family:Ubuntu Mono; font-style:normal; }
	.T23 { font-family:Ubuntu Mono; font-style:normal; }
	.T24 { font-family:Ubuntu Mono; }
	.T26 { font-family:Linux Libertine O; font-style:normal; }
	.T27 { font-family:Linux Libertine O; font-style:normal; }
	.T28 { font-family:Linux Libertine O; font-style:normal; }
	.T29 { font-family:Linux Libertine O; font-style:normal; }
	.T3 { color:#579d1c; }
	.T30 { font-family:Linux Libertine O; font-style:normal; }
	.T31 { font-family:Linux Libertine O; }
	.T32 { font-family:Linux Libertine O; }
	.T37 { color:#333333; font-family:Linux Libertine O; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T38 { color:#333333; font-family:Linux Libertine O; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T39 { color:#333333; font-family:Linux Libertine O; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T4 { color:#579d1c; font-size:8pt; font-style:normal; }
	.T40 { color:#333333; font-family:Ubuntu Mono; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T41 { color:#333333; font-family:Ubuntu Mono; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T42 { color:#333333; font-family:Ubuntu Mono; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T43 { color:#333333; font-family:Ubuntu Mono; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:normal; background-color:transparent; }
	.T46 { vertical-align:super; font-size:58%;}
	.T47 { color:#0084d1; font-style:italic; }
	.T48 { color:#0084d1; font-style:italic; }
	.T5 { font-style:italic; }
	.T50 { font-size:8pt; font-style:normal; }
	.T6 { font-style:italic; }
	.T7 { font-style:italic; }
	.T8 { font-style:italic; }
	.T9 { font-style:italic; }
	<!-- ODF styles with no properties representable as CSS -->
	.T10 .T11 .T12 .T18 .T25 .T33 .T34 .T35 .T36 .T44 .T45 .T49 .T51  { }
	</style></head><body dir="ltr" style="max-width:8.5in;margin-top:0.7874in; margin-bottom:0.7874in; margin-left:0.7874in; margin-right:0.7874in; writing-mode:lr-tb; "><p class="P50">Debugging and Profiling</p><p class="P3"> </p><p class="P28">Errors &amp; Error Handling</p><p class="P30">Bugs</p><p class="P6">Various versions of this have been floating around:  I recomposed this based on the original psychological definitions.</p><p class="P6"> </p><p class="P6"><span class="T3">        Denial</span><span> </span><span> "I feel fine."; "This can't be happening, not to me."</span></p><p class="P6"><span> </span><span> <span class="T5">Denial is usually only a temporary defense for the individual.</span></span></p><p class="P6"><span class="T3">        Anger</span><span> </span><span> "Why me? It's not fair!"; "How can this happen to me?"; '"Who is to blame?"</span></p><p class="P6"><span> </span><span> <span class="T5">Because of anger, the person is difficult to care for due to feelings of rage and envy.</span></span></p><p class="P6"><span class="T3">        Bargaining</span><span> "I'll do anything for a few more years."; "I will give my life savings if..."</span></p><p class="P6"><span> </span><span> <span class="T5">The third stage involves the hope that the individual can postpone or delay </span><span class="T6">[bugs]</span><span class="T5">.</span></span></p><p class="P6"><span class="T3">        Depression</span><span> "I'm so sad, why bother with anything?"; "I miss my loved one, why go on?"</span></p><p class="P7"><span> </span><span> During the fourth stage, the grieving person begins to understand the certainty of <span class="T10">[bugs]</span>.</span></p><p class="P6"><span class="T3">        Acceptance</span><span> "It's going to be okay."; "I can't fight it, I may as well prepare for it."</span></p><p class="P6"><span> </span><span> <span class="T5">In this last stage, individuals begin to come to terms with their </span><span class="T6">[code's bugginess]</span><span class="T5">.</span></span></p><p class="P6"> </p><p class="P4">In the face of ambiguity, refuse the temptation to guess.</p><p class="P9"><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> —T<span class="T11">he </span><span class="T7">Zen of Python</span></span></p><p class="P6"> </p><p class="P31">Definitions</p><p class="P6"><span class="T3">Errors</span>—exceptions which cause the program to be unrunnable (cannot be handled at run time)</p><p class="P6"><span class="T3">Exceptions</span>—<span class="T12">unusual behavior (although not necessarily </span><span class="T8">unexpected</span><span class="T14"> behavior, particularly in Python)</span></p><p class="P10"><span class="T3">Tracebacks</span>—listing of function calls on the stack at the time the exception arises</p><p class="P10"> </p><p class="P31">Errors</p><p class="P11">Typically SyntaxError, which renders the program unrunnable (but we'll discuss linting below).</p><p class="P11"> </p><p class="P31">Exceptions</p><p class="P6"><span class="T18">[I</span>nvoke live with examples in ipython:  "<span class="T19">(hga</span>"<span class="T18">; examples can also be found in lessons/thw-python-debugging/examples]</span></p><p class="P6"> </p><p class="P37">        SyntaxError # <span class="T25">Check missing colons or parentheses</span></p><p class="P37">        NameError   # <span class="T25">Check for typos, function definitions</span></p><p class="P37">        TypeError   # <span class="T25">Check variable types (coerce if necessary)</span></p><p class="P37">        ValueError  # <span class="T25">Check function parameters</span></p><p class="P37">        IOError     # <span class="T25">Check that files exist</span></p><p class="P37">        IndexError  # <span class="T25">Don't reference nonexistent list elements</span></p><p class="P37">        KeyError    # Similar to an IndexError, but for dictionaries</p><p class="P37">        ZeroDivisionError   # Three guesses...</p><p class="P37">        Exception   # <span class="T25">Generic error category</span></p><p class="P6"> </p><p class="P32">Exercises</p><ul><li><p class="P42" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T27">O</span><span class="T26">pen the examples of bad code.  See if the students can identify why each error is thrown.</span><span class="odfLiEnd"/> </p></li><li><p class="P43" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T27">Write</span><span class="T28"> </span><span class="T27">some snippets of code which throw</span><span class="T28"> the following exceptions:   </span><span class="T21">SyntaxError</span><span class="T29">, </span><span class="T24">NameError</span><span class="T31">, </span><span class="T24">TypeError</span><span class="T31">, </span><span class="T24">ValueError</span><span class="T31">, </span><span class="T24">IOError</span><span class="T31">, </span><span class="T24">IndexError</span><span class="T31">, </span><span class="T24">KeyError</span><span class="T32">, </span><span class="T21">ZeroDivisionError</span><span class="odfLiEnd"/> </p></li></ul><p class="P6"> </p><p class="P33">Tracebacks</p><p class="P11">The stack is inti<span class="T33">m</span>idating, but you can generally tease out the information you need.  <span class="T34">There is an immediate listing of the function calls, line numbers, and general condition of the stack at the moment of failure.  We will also discuss debugging, which allows you to explore the exceptions in much greater detail:  we'll show how to identify failure conditions and unexpected behavior.</span></p><p class="P6"> </p><p class="P28">Debugging &amp; Profiling</p><p class="P44"><span class="T35">Illustrate these using material from lessons/thw-python-debugging/examples/</span>.</p><p class="P34"> </p><p class="P35">Linting</p><p class="P12"><span class="T35">As I said before, you can debug by simply attempting to run your code.  This, however, is very annoying.  First off, the code will always stop at the first exception.  This means that, if you have ten errors, you'll have to run the code ten times to find all of them.  Now, imagine that this is long-running code.  Imagine waiting five minutes for your code to run, only to discover it breaks because of a typo.  Doesn't </span><span class="T9">that</span><span class="T35"> sound exciting?</span></p><p class="P12"> </p><p class="P12">Linting is the process of <span class="T36">statically analyzing the code in order to catch multiple errors simultaneously (rather than dealing with them one at a time in the debugger).  There are several available; I'll illustrate the use of pyflakes.</span></p><p class="P38"><span> <span class="T35">$ pyflakes my_code.py</span></span></p><p class="P12"> </p><p class="P36"><span class="T36">C</span>oding Standards</p><p class="P18">In a written natural language, there are many ways to express the same idea.  To make the consumption of information easier, people define style guides to enforce particularly effective ways of writing.  This is even more true in coding; consistent style choices make scripts much easier to read.  They become absolutely essential as projects become large (&gt;1 person).</p><p class="P18"> </p><p class="P18">Some programming languages have multiple competing standards, and it's easy to imagine how messy this can get.  You can find strong opinions on what constitutes a tab, for instance.  Luckily, Python doesn't have this issue.  The official standard, PEP8, is used everywhere.  Unless you plan on hiding all the code you write from the outside world, you should learn it.</p><p class="P18">To help out coders, there are tools to test for compliance.  The aptly named <span class="T19">pep8</span> library shows you where your code deviates from the PEP8 standard, and <span class="T19">autopep8</span> goes a step further by trying to fix all of your errors for you.  These are both run from the shell, as</p><p class="P37"><span> <span class="T36">$ </span>pep8 <span class="T36">my_code.py</span></span></p><p class="P37"><span> <span class="T36">$ </span>autopep8 <span class="T36">my_code.py &gt; my_new_code.py</span></span></p><p class="P12"> </p><p class="P35">Debugging</p><p class="P13">Effective debugging will often utilize unit testing or a standard set of answers to problems (if known) in order to determine if your code is working as you expect it to. </p><p class="P8"> </p><p class="P35">Profiling</p><p class="P20"><span class="Source_20_Text"><span class="T37">A profiler runs your code inside of a framework which it can query hundreds or thousands of times per second in order to create a breakdown of where time is spent in the program.  This allows you to identify bottlenecks to target in your optimization efforts.</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T38"/></span></p><p class="P1"><span class="Source_20_Text"><span class="T38">We will discuss CPU time profiling only (you can also profile memory, input/output speed, etc.). There are </span></span><span class="Source_20_Text"><span class="T39">three</span></span><span class="Source_20_Text"><span class="T38"> main </span></span><span class="Source_20_Text"><span class="T39">ways</span></span><span class="Source_20_Text"><span class="T38"> you can </span></span><span class="Source_20_Text"><span class="T39">accomplish this in Python</span></span><span class="Source_20_Text"><span class="T38">.</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T38"/></span></p><p class="P1"><span class="Source_20_Text"><span class="T38">First, you can use the </span></span><span class="Source_20_Text"><span class="T41">time</span></span><span class="Source_20_Text"><span class="T38"> package as a stopwatch on specific functions and make your own </span></span><span class="Source_20_Text"><span class="T38">comparisons (this is the equivalent of using </span></span><span class="Source_20_Text"><span class="T41">print</span></span><span class="Source_20_Text"><span class="T38"> as a debugger).</span></span></p><p class="P1"><a href="https://speakerdeck.com/rwarren/a-brief-intro-to-profiling-in-python"><span class="Source_20_Text"><span class="T3">https://speakerdeck.com/rwarren/a-brief-intro-to-profiling-in-python</span></span></a><span class="Source_20_Text"><span class="T38"> </span></span></p><p class="P1"><span class="Source_20_Text"><span class="T41">        import time</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T41">        start = time.time()</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T41">        myFunc()</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T41">        end = time.time()</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T41">        print(repr(end-start), " s elapsed.")</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T38"/></span></p><p class="P1"><span class="Source_20_Text"><span class="T39">Secondly, </span></span><span class="Source_20_Text"><span class="T38">you can use the </span></span><span class="Source_20_Text"><span class="T41">timeit</span></span><span class="Source_20_Text"><span class="T38"> module </span></span><span class="Source_20_Text"><span class="T39">either inside or outside of your code </span></span><span class="Source_20_Text"><span class="T38">to accomplish something similar (best of three).</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T41">        </span></span><span class="Source_20_Text"><span class="T42">$ </span></span><span class="Source_20_Text"><span class="T41">python -m timeit "</span></span><span class="Source_20_Text"><span class="T43">x=2**100;x**100</span></span><span class="Source_20_Text"><span class="T41">"</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T38"/></span></p><p class="P1"><span class="Source_20_Text"><span class="T39">Finally</span></span><span class="Source_20_Text"><span class="T38">, you can use the built-in profiling tool which gives you an embarassment of riches on timing information.</span></span></p><p class="P1"><span class="Source_20_Text"><span class="T40">        </span></span><span class="Source_20_Text"><span class="T42">$ </span></span><span class="Source_20_Text"><span class="T40">python -m cProfile -s time my_code.py</span></span></p><p class="P6"> </p><p class="P20">Profilers are inappropriate for benchmarking.  For instance, cProfile introduces a relative overhead for Python programs as opposed to C, making the C functions called in the code proportionally faster.</p><p class="P20"> </p><div class="P21"><p> </p>A<span class="T44">nother</span> useful tool is RunSnakeRun, which can take the cProfile output and render it more legible (including showing nested system calls).</div><p class="P39"><span> <span class="T36">$ sudo port install wxWidgets-devel #on Mac</span></span></p><p class="P40"><span> $ cd wxPython-src-2.9.0.1/wxPython</span></p><p class="P40"><span> $ sudo python build-wxpython.py –build_dir=../bld</span></p><p class="P40"><span> $ sudo easy_install wxpython SquareMap RunSnakeRun</span></p><p class="P40"><span> $ python -m cProfile -s time my_code.py &gt; my_code.profile</span></p><p class="P40"><span> $ runsnake my_code.profile</span></p><p class="P40"><span> </span></p><p class="P40"><span> <span class="T45">$ sudo yum install wxPython #on Fedora Linux</span></span></p><p class="P41"><span> $ sudo easy_install SquareMap RunSnakeRun</span></p><p class="P40"><span class="T45">        </span>$ python -m cProfile -s time my_code.py &gt; my_code.profile</p><p class="P41"><span> $ runsnake my_code.profile</span></p><p class="P21">You also need to be aware of the granularity of your system clock.  Small values (&lt;10<span class="T46">-6</span> s) are possibly meaningless and so you should use large numbers of calls instead if you need to know small differences.</p><p class="P20"> </p><p class="P20">In Matlab, I have seen worse than 10× slowdown by invoking profiling; Python seems to give about a 20–30% slowdown in my experience.  In any case, you won't leave it on when you're not actively profiling so it's not that big of a deal.</p><p class="P6"> </p><p class="P32">Exercises</p><ul><li><p class="P19" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T15">P</span><span class="T13">rofile the </span><span class="T16">code in the cse-debug/stats directory.</span><span class="T13">  Which function is taking up the most time?</span><span class="odfLiEnd"/> </p></li></ul><p class="P6"> </p><p class="P29">Handling Errors at Runtime</p><p class="P6"><span class="T47">Throwing &amp; </span><span class="T48">C</span><span class="T47">atching</span></p><p class="P11">This is a surprisingly controversial topic even within Python.  I'll <span class="T49">tell you how it works and then </span>give you my advice.  <span class="T49">You can then</span> delve into others' opinions if you like as well.</p><p class="P6"> </p><p class="P47">try:</p><p class="P47"><span> readFromFile(inputFile)</span></p><p class="P47"><span> writeToFile(outputFile)</span></p><p class="P47">except IOException:</p><p class="P47"><span> # deal with fallout</span></p><ul><li><p class="P22" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>Why is this code fragment particularly <span class="T49">pernicious</span>?<span class="odfLiEnd"/> </p></li></ul><p class="P24"> </p><p class="P6"><span class="T19">finally</span>:  A finally block always executes, even if you return before it would typically be arrived at.</p><p class="P24"> </p><p class="P32">Exercises</p><ul><li><p class="P43" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T27">Pull up your snippets of code which threw exceptions before.</span><span class="T28">  </span><span class="T27">Tr</span><span class="T28">y to handle each of them appropriately </span><span class="T27">with an except clause</span><span class="T28">.  </span><span class="T27">(In other words, your code should overall run without showing a traceback.)</span><span class="odfLiEnd"/> </p></li></ul><p class="P24"> </p><p class="P25">Now we've practiced this, but I will counsel you that y<span class="T11">ou should rarely write your own exception handling.  </span>It's rather a philosophical debate, but </p><p class="P6"> </p><p class="P26">Arguments <span class="T5">against</span><span class="T13"> exception handling:</span></p><ul><li><p class="P5" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T15">E</span><span class="T13">xception handling lies perilously close to "goto" spaghetti code because you aren't required to preserve scope.</span><span class="odfLiEnd"/> </p></li><li><p class="P45" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T22">try</span><span class="T28">/</span><span class="T22">except</span><span class="T28">/</span><span class="T23">else</span><span class="T30">/</span><span class="T22">finally</span><span class="T28"> control flow can be hard to follow.</span><span class="odfLiEnd"/> </p></li><li><p class="P14" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>Exception handling is slow:  but this isn't appreciably true in Python!<span class="odfLiEnd"/> </p></li><li><p class="P23" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T22">try</span><span class="T15">/</span><span class="T22">except</span><span class="T15">/</span><span class="T20">else</span><span class="T13">/</span><span class="T22">finally</span><span class="T15"> </span><span class="T17">i</span><span class="T13">mpacts code readability (superfluous indentations </span><span class="T17">and breaks</span><span class="T13">).</span><span class="odfLiEnd"/> </p></li><li><p class="P15" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>Exceptions should indicate exceptional situations, not normally anticipated ones.<span class="odfLiEnd"/> </p></li></ul><p class="P6"> </p><p class="P26">Arguments <span class="T5">in favor of</span><span class="T13"> exception handling:</span></p><ul><li><p class="P46" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span><span class="T28">Python uses exceptions in regular control flow (</span><span class="T22">for</span><span class="T28"> loops </span><span class="T30">use</span><span class="T28"> </span><span class="T23">StopIteration</span><span class="T30"> exception</span><span class="T28">).</span><span class="odfLiEnd"/> </p></li><li><p class="P16" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>Exception handling isn't slow in Python.<span class="odfLiEnd"/> </p></li><li><p class="P16" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>If you are writing a library function to be called repeatedly, some robust exception-handling may be called for.<span class="odfLiEnd"/> </p></li></ul><p class="P6"> </p><p class="P25">If you decide that it is necessary for you to write exception-handling code, follow these principles:</p><ul><li><p class="P16" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>If anything you can do can recover from the error, catch the exception and deal with it.<span class="odfLiEnd"/> </p></li><li><p class="P16" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>If the error is extremely common, return error codes in a tuple rather than handling it.<span class="odfLiEnd"/> </p></li><li><p class="P16" style="margin-left:0cm;"><span class="Bullet_20_Symbols" style="display:block;float:left;min-width:0.635cm;">■</span>If nothing you can do can recover from the error, leave it uncatched or try to perform a marginally graceful shutdown of the program.<span class="odfLiEnd"/> </p></li></ul><p class="P25"><span class="T50">(Adapted from cwap, </span><a href="http://stackoverflow.com/questions/729379/why-not-use-exceptions-as-regular-flow-of-control"><span class="T4">http://stackoverflow.com/questions/729379/why-not-use-exceptions-as-regular-flow-of-control</span></a><span class="T50">)</span></p><p class="P6"> </p><p class="P25">In any case, follow the principle of least astonishment and avoid bogging down later researchers perusing your code.</p><p class="P6"> </p><p class="P48">The Principle of Least Astonishment</p><p class="P49"><span class="T33">T</span>he result of performing some operation should be obvious, consistent, and predictable, based upon the name of the operation and other clues.</p><p class="P6"> </p><p class="P27">In any case, you <span class="T51">will </span>need to read and follow exception handling code if you're going to work substantially with any existing libraries or code.</p><p class="P6"> </p><p class="P17">————————</p><p class="P2"><span class="T1">This document was created by Neal Davis for Computational Science &amp; Engineering at the University of Illinois at Urbana–Champaign.  It incorporates some elements from Software Carpentry, </span><span class="T2">contributed by Greg Wilson and others;</span><span class="T1"> and The Hacker Within, contributed by Katy Huff, Anthony Scopatz, Joshua R. Smith, and Sri Hari Krishna Narayanan.</span></p></body></html>
